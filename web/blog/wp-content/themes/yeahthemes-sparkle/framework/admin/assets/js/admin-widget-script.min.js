if("undefined"==typeof Yeahthemes)var Yeahthemes={};!function(e){"use strict";"undefined"!=typeof Yeahthemes&&(Yeahthemes.WidgetActions={init:function(){var t=this;e(document).ajaxComplete(function(){t.callFunctions()}).on("ready",function(){t.callFunctions()}).on("nested-widget-added",function(){setTimeout(function(){t.callFunctions()},500)}).on("click",".yt-widget-reapeatable-field-add",t.repeatableField.addField).on("click",".yt-widget-reapeatable-field-remove",t.repeatableField.removeField)},callFunctions:function(){this.colorPicker(".yt-colorpicker"),this.ajaxSearchPostPage(),this.ajaxSearchTag(),this.repeatableField.initSortable()},colorPicker:function(t){e(t).each(function(){var t=e(this);if(!t.hasClass("wp-color-picker")&&!t.closest("#available-widgets").length){var a={defaultColor:t.data("std"),change:function(){},clear:function(){},hide:!0,palettes:!0};t.wpColorPicker(a)}})},repeatableField:{initSortable:function(){var t=e(".yt-widget-reapeatable-field-wrapper");t.each(function(){var t=e(this);t.hasClass("ui-sortable")||t.closest("#available-widgets").length||t.sortable({items:"> .yt-widget-reapeatable-field",opacity:.6,revert:!0,placeholder:"ui-sortable-placeholder",start:function(){},stop:function(){},sort:function(e,t){t.placeholder.css({height:t.item.height()-2,border:"1px dashed #CCC","margin-bottom":10})},update:function(t,a){var i=e(this);a.item.addClass("open"),Yeahthemes.WidgetActions.repeatableField.refreshFields(i)}})})},addField:function(t){var a=e(this),i=a.siblings(".yt-widget-reapeatable-field-wrapper"),n=e(".yt-widget-reapeatable-field:first",i).clone();e(n).find("[name]").val(""),e(n).find("option").removeAttr("selected"),e(n).find('[type="checkbox"]').removeAttr("checked"),e(n).addClass("open").find(".widget-inside").show(),e(n).appendTo(i),Yeahthemes.WidgetActions.repeatableField.refreshFields(i),i.hasClass("ui-sortable")&&i.sortable("refresh"),t.preventDefault()},removeField:function(t){var a=e(this),i=a.closest(".yt-widget-reapeatable-field"),n=a.closest(".yt-widget-reapeatable-field-wrapper");i.siblings(".yt-widget-reapeatable-field").length?i.remove():(alert(yt_widgetVars.msgAlertLastField),i.find('[type="text"], textarea').each(function(){e(this).val("")})),Yeahthemes.WidgetActions.repeatableField.refreshFields(n),n.hasClass("ui-sortable")&&n.sortable("refresh"),t.preventDefault()},refreshFields:function(t){setTimeout(function(){e(".yt-widget-reapeatable-field",t).each(function(t){var a=e(this);a.find("[data-name]").each(function(){var a=e(this).data("name");if(a){var i=a.replace("__x_*_x__",t);e(this).attr("name",i)}})})},500)}},ajaxSearchTag:function(){e(".yt-ajax-tag-search").each(function(){{var t,a=e(this),i=a.data("tax")||"post_tag",n=a.siblings("input[type=hidden]"),s=(a.siblings("input[type=button]"),a.siblings(".yt-tag-list")),l=",";n.val(),e("a",s)}a.hasClass("ui-autocomplete-input")||a.closest("#available-widgets").length||(a.autocomplete({source:function(t,n){e.ajax({url:ajaxurl,type:"GET",async:!0,cache:!1,dataType:"json",data:{action:"yt_ajax_tag_search",tax:i,q:e.trim(a.val())},success:function(e){n(jQuery.map(e,function(e){return{id:e.id,name:e.name}}))}})},minLength:2,delay:500,response:function(){a.removeClass("ui-autocomplete-loading")},open:function(){},close:function(){},focus:function(t,a){t.preventDefault(),e(this).val(a.item.name)},change:function(){},search:function(){},select:function(e,a){s.append('<span data-id="'+a.item.id+'"><a class="ntdelbutton">x</a>&nbsp;'+a.item.name+"</span>"),t=n.val()+l+a.item.id,t=Yeahthemes.WidgetActions.helper.arrayUniqueNoempty(t.split(l)),n.val(t)}}).data("ui-autocomplete")._renderItem=function(e,t){return jQuery('<li data-id="'+t.id+'">').append("<a><strong>"+t.name+"</strong></a>").appendTo(e)},e(document).on("click",".yt-tag-list a",function(a){var i=e(this).parent("span").data("id");t=n.val().split(l);for(var s=t.length-1;s>=0;s--)parseInt(t[s])===parseInt(i)&&t.splice(s,1);t=t.join(l),n.val(t),e(this).parent().remove(),a.preventDefault()}))})},ajaxSearchPostPage:function(){e(".yt-ajax-post-search").each(function(){{var t,a=e(this),i=a.data("type")||"post",n=a.siblings("input[type=hidden]"),s=(a.siblings("input[type=button]"),a.siblings(".yt-tag-list")),l=",";n.val(),e("a",s)}a.hasClass("ui-autocomplete-input")||a.closest("#available-widgets").length||(a.autocomplete({source:function(t,n){e.ajax({url:ajaxurl,type:"GET",async:!0,cache:!1,dataType:"json",data:{action:"yt_ajax_post_search",s:e.trim(a.val()),type:i},success:function(e){null!=e&&n(jQuery.map(e,function(e){return{id:e.id,name:e.name}}))}})},minLength:2,delay:500,response:function(){a.removeClass("ui-autocomplete-loading")},open:function(){},close:function(){},focus:function(t,a){t.preventDefault(),e(this).val(a.item.name)},change:function(){},search:function(){},select:function(e,a){s.append('<span data-id="'+a.item.id+'"><a class="ntdelbutton">x</a>&nbsp;'+a.item.name+"</span>"),t=n.val()+l+a.item.id,t=Yeahthemes.WidgetActions.helper.arrayUniqueNoempty(t.split(l)),n.val(t)}}).data("ui-autocomplete")._renderItem=function(e,t){return jQuery('<li data-id="'+t.id+'">').append("<a><strong>"+t.name+"</strong></a>").appendTo(e)},e(document).on("click",".yt-tag-list a",function(a){var i=e(this).parent("span").data("id");t=n.val().split(l);for(var s=t.length-1;s>=0;s--)parseInt(t[s])===parseInt(i)&&t.splice(s,1);t=t.join(l),n.val(t),e(this).parent().remove(),a.preventDefault()}))})},helper:{arrayUniqueNoempty:function(e){var t=[];return jQuery.each(e,function(e,a){a=jQuery.trim(a),a&&-1==jQuery.inArray(a,t)&&t.push(a)}),t},triggering:function(t,a){return e(t).length&&e(t).trigger(a),!1},escapeHtml:function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}}},Yeahthemes.WidgetActions.init())}(jQuery);